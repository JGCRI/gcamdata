<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Running GCAM Data System with drake • gcamdata</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Running GCAM Data System with drake">
<meta property="og:description" content="gcamdata">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gcamdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/driverdrake_vignette.html">driver_drake</a>
    </li>
    <li>
      <a href="../articles/usermod_vignette.html">User Modification Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JGCRI/gcamdata/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="driverdrake_vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Running GCAM Data System with drake</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JGCRI/gcamdata/blob/HEAD/vignettes/driverdrake_vignette.Rmd" class="external-link"><code>vignettes/driverdrake_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>driverdrake_vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The function <code><a href="../reference/driver_drake.html">driver_drake()</a></code>, located in <code>R/driver.R</code>, runs the GCAM data system, like <code><a href="../reference/driver.html">driver()</a></code>. However, unlike <code><a href="../reference/driver.html">driver()</a></code>, <code><a href="../reference/driver_drake.html">driver_drake()</a></code> skips steps that are already up-to-date, saving time. The central function of <code>drake</code> is <code><a href="https://docs.ropensci.org/drake/reference/make.html" class="external-link">drake::make()</a></code>, which builds the data system. <code>drake</code>’s <code>make</code> is more sophisticated than the standard GNU <code>make</code> based systems because it checks the content has substantively changed instead of only if a file has been modified, and similarly only runs subsequent steps that are actually affected by the latest changes since the previous <code>make()</code>.</p>
<p>In this vignette we will go through concrete examples which highlight these benefits. In addition we will give examples of common tasks when working with <code>drake</code> and provide links to further documentation.</p>
<div class="section level3">
<h3 id="timing">Timing<a class="anchor" aria-label="anchor" href="#timing"></a>
</h3>
<p>Using <code><a href="../reference/driver_drake.html">driver_drake()</a></code> significantly speeds up the process for making changes after the initial data system build. However due to the additional overhead of caching results the initial data system build <em>may</em> be slower (See <a href="%22#parallel-computing%22">Parallel Computing</a> than regular <code><a href="../reference/driver.html">driver()</a></code>. On a local Windows machine, the initial run of <code><a href="../reference/driver_drake.html">driver_drake()</a></code> took 25 minutes and 11 seconds, while the initial run of <code><a href="../reference/driver.html">driver()</a></code> took 17 minutes and 4 seconds. However, as an example, after editing a single input file <code>A10.TechChange.csv</code>, <code>driver_drake</code> updated 44 targets and took 1 minute and 7 seconds to run. With <code><a href="../reference/driver.html">driver()</a></code>, the full data system would have to be rerun.</p>
</div>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h3>
<p>The <code>drake</code> package has many features that can be used with <code>gcamdata</code> that are not discussed here. <code>drake</code>’s documentation is very good and includes many helpful resources. To learn more about what <code>drake</code> can do and how it works, the <a href="https://books.ropensci.org/drake/" class="external-link">The drake R Package Users Manual</a> is a good place to start.</p>
</div>
<div class="section level3">
<h3 id="drakes-cache">
<code>drake</code>’s cache<a class="anchor" aria-label="anchor" href="#drakes-cache"></a>
</h3>
<p>When running <code>make()</code>, <code>drake</code> stores your targets in a hidden cache by default named <code>.drake</code> in your current working directory. Typically a user does not need to directly manipulate this cache but in some cases they may wish to. For recovery purposes, drake keeps all targets from all runs of <code>make()</code>. To delete this cache and rerun the data system from scratch, you can safely delete the <code>.drake</code> folder. Sometimes when a chunk errors during processing you may be left with a “locked” cache. If the cache is locked, you can force unlock with <code>drake::drake_cache()$unlock()</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>Let’s explore <code><a href="../reference/driver_drake.html">driver_drake()</a></code> and see how it can help us run the data system. We’ll start by doing an initial run which will create and store output in the drake cache and create all of our xml files. We run this just as we would <code><a href="../reference/driver.html">driver()</a></code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ben Bond-Lamberty, Katherine Calvin, Ryna Cui, Kalyn Dorheim, Leyang Feng, Jill Horing, Russell Horowitz, Page Kyle, Robert Link, Pralit Patel, Christopher Roney, Abigail Snyder, Aaron Staniszweski, Sean Turner, Matthew Binsted, Zarrar Khan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
