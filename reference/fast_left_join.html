<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fast left join for large tables — fast_left_join • gcamdata</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fast left join for large tables — fast_left_join"><meta property="og:description" content="The dplyr join functions are a little on the slow side for very large
tables.  This version converts its inputs
data.table structures, and uses that package's
faster indexing capabilities to do a faster join."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gcamdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/driverdrake_vignette.html">driver_drake</a>
    </li>
    <li>
      <a href="../articles/usermod_vignette.html">User Modification Functions</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/JGCRI/gcamdata/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast left join for large tables</h1>
    <small class="dont-index">Source: <a href="https://github.com/JGCRI/gcamdata/blob/HEAD/R/pipeline-helpers.R" class="external-link"><code>R/pipeline-helpers.R</code></a></small>
    <div class="hidden name"><code>fast_left_join.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The dplyr join functions are a little on the slow side for very large
tables.  This version converts its inputs
<code><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> structures, and uses that package's
faster indexing capabilities to do a faster join.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fast_left_join</span><span class="op">(</span><span class="va">left</span>, <span class="va">right</span>, <span class="va">by</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>left</dt>
<dd><p>The left-side table to join.  Any class inheriting from
<code>data.frame</code> is acceptable.</p></dd>


<dt>right</dt>
<dd><p>The right-side table to join.  Any class inheriting from
<code>data.frame</code> is acceptable.</p></dd>


<dt>by</dt>
<dd><p>Character vector of column names to join by.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The left join of <code>left</code> and <code>right</code>.  It will be returned
as a <code>tbl_df</code>, irrespective of the type of the inputs.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Because there is some overhead associated with setting up and indexing the
data.table structures, this function is only useful when the right-side table
is big enough that the savings in the join to make up for the overhead.
Therefore, this function should only be used for joins that are demonstrably
causing bottlenecks due to the size of the tables involved.  This version
should <em>never</em> be the first choice in development.  As a rule of thumb,
any join that is taking more than 500ms using the dplyr join functions is a
candidate for this function.</p>
<p>When using this function, be aware that data.table has some slightly
different conventions for handling duplicated columns that are not being
joined on.  Suppose we have tables <code>A</code> and <code>B</code>, both of which have
a column <code>value</code> that is not being joined on.  Then,
<code>AB &lt;- dplyr::left_join(A, B)</code> will have columns <code>AB$value.x</code> with
the values from table <code>A</code> and <code>AB$value.y</code> with the values from
table <code>B</code>.  In <code>AB &lt;- gcamdata::fast_left_join(A, B)</code>, the
corresponding columns will be <code>AB$i.value</code> for the values from table
<code>A</code>, and <code>AB$value</code> <em>(sic)</em> for the values from table
<code>B</code>.  This function makes no attempt to correct the column names in the
result to conform to the dplyr convention, and is therefore not exactly a
drop-in replacement for <code>left_join</code>.  However, it is usually easy enough
to make corrections on the returned value.</p>
<p>Since this function is intended only for specialized use, we don't provide
any of the other join variants like first-only or error-no-match.  The cases
where that extra functionality is needed <em>and</em> the tables involved are
too large for the slower version of join are uncommon enough that they can be
handled on a case by case basis.  (That's documentation-speak for "You're on
your own.")</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ben Bond-Lamberty, Katherine Calvin, Ryna Cui, Kalyn Dorheim, Leyang Feng, Jill Horing, Russell Horowitz, Page Kyle, Robert Link, Pralit Patel, Christopher Roney, Abigail Snyder, Aaron Staniszweski, Sean Turner, Matthew Binsted, Zarrar Khan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

